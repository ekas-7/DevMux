(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{50762:(e,s,a)=>{Promise.resolve().then(a.bind(a,64285))},64285:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>w});var r=a(95155),t=a(2615),i=a(12115),l=a(12366),n=a(50437),d=a(24659),c=a(16481),o=a(68313),m=a(12472),x=a(21354),h=a(689),u=a(87936),g=a(76046),p=a(96758);function j(){let e=(0,g.useRouter)(),[s,a]=(0,i.useState)(""),[t,d]=(0,i.useState)(""),[c,o]=(0,i.useState)(!1),[m,x]=(0,i.useState)(!1),h=async()=>{try{o(!0);let e=Math.random().toString(36).substring(7),s=await fetch("/api/meetings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:e})});if(!s.ok)throw Error("Failed to create meeting");let r=await s.json();a(r.roomId||e)}catch(e){console.error("Error creating meeting:",e)}finally{o(!1)}},u=s=>{e.push("/meeting/".concat(s))},j=async()=>{await navigator.clipboard.writeText(s),x(!0),setTimeout(()=>x(!1),2e3)};return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[m&&(0,r.jsx)("div",{className:"fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded shadow",children:"Room ID copied to clipboard!"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"border-2 border-blue-500/20 rounded-lg p-6 shadow",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,r.jsx)(l.A,{className:"w-6 h-6 text-blue-500"}),(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Start a New Meeting"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("button",{onClick:h,className:"w-full px-4 py-2 text-white font-medium rounded ".concat(c?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"),disabled:c,children:c?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Creating..."})]}):"Create Meeting"}),s&&(0,r.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-blue-100 rounded-lg",children:[(0,r.jsx)("code",{className:"text-blue-500 flex-1",children:s}),(0,r.jsx)("button",{onClick:j,className:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]}),(0,r.jsx)("button",{onClick:()=>u(s),className:"w-full px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Join Now"})]})]})]}),(0,r.jsxs)("div",{className:"border-2 border-purple-500/20 rounded-lg p-6 shadow",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,r.jsx)(n.A,{className:"w-6 h-6 text-purple-500"}),(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Join an Existing Meeting"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("input",{type:"text",value:t,onChange:e=>d(e.target.value),placeholder:"Enter Room ID",className:"w-full px-4 py-2 border-2 rounded focus:ring focus:ring-purple-500 bg-inherit"}),(0,r.jsx)("button",{onClick:()=>u(t),disabled:!t.trim(),className:"w-full px-4 py-2 text-white font-medium rounded ".concat(t.trim()?"bg-purple-600 hover:bg-purple-700":"bg-gray-400"),children:"Join Meeting"})]})]})]})]})}var b=a(69253);function f(){let[e,s]=(0,i.useState)([]),[a,t]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/meetings");if(!e.ok)throw Error("Failed to fetch meetings");let a=await e.json();s(a)}catch(e){console.error("Error fetching meetings:",e)}finally{t(!1)}})()},[]),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Previous Meetings"}),a?(0,r.jsx)("div",{className:"grid gap-4",children:Array.from({length:3}).map((e,s)=>(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg p-6 animate-pulse",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"w-40 h-4 bg-gray-600 rounded-md"}),(0,r.jsx)("div",{className:"w-32 h-4 bg-gray-600 rounded-md"}),(0,r.jsxs)("div",{className:"mt-2 space-y-2",children:[(0,r.jsx)("div",{className:"w-20 h-4 bg-gray-600 rounded-md"}),(0,r.jsx)("div",{className:"w-full h-3 bg-gray-600 rounded-md"}),(0,r.jsx)("div",{className:"w-3/4 h-3 bg-gray-600 rounded-md"})]})]})},s))}):(0,r.jsx)("div",{className:"grid gap-4",children:e.map(e=>(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg p-6",children:(0,r.jsx)("div",{className:"flex justify-between items-start",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-gray-300",children:["Date: ",(0,b.GP)(new Date(e.startTime),"PPP")]}),(0,r.jsxs)("p",{className:"text-gray-300",children:["Duration: ",e.duration?"".concat(e.duration," minutes"):"Ongoing"]}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("p",{className:"text-gray-400",children:["Host: ",e.host.name]}),(0,r.jsx)("p",{className:"text-gray-400",children:"Participants:"}),(0,r.jsx)("ul",{className:"list-disc list-inside",children:e.participants.map((e,s)=>(0,r.jsx)("li",{className:"text-gray-300",children:e.name},s))})]})]})})},e.id))})]})}function y(){let[e,s]=(0,i.useState)(""),[a,t]=(0,i.useState)([]),[l,n]=(0,i.useState)(!1),[d,c]=(0,i.useState)(""),o=async()=>{if(!e.trim()){c("Please enter a search term");return}n(!0),c(""),t([]);try{let s=await fetch("/api/users/search?q=".concat(encodeURIComponent(e.trim())));if(!s.ok)throw Error("Failed to search users");let a=await s.json();t(a),0===a.length&&c("No users found")}catch(e){console.error("Error searching users:",e),c("Failed to search users")}finally{n(!1)}},m=async e=>{try{if(!(await fetch("/api/friends/requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({receiverEmail:e})})).ok)throw Error("Failed to send friend request");t(s=>s.filter(s=>s.email!==e)),c("Friend request sent successfully!")}catch(e){console.error("Error sending friend request:",e),c("Failed to send friend request")}};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>s(e.target.value),onKeyDown:e=>"Enter"===e.key&&o(),placeholder:"Search users by name or email",className:"flex-1 px-4 py-2 rounded-lg bg-gray-700 text-white"}),(0,r.jsx)("button",{onClick:o,disabled:l,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white disabled:opacity-50",children:l?"Searching...":"Search"})]}),d&&(0,r.jsx)("p",{className:"text-sm ".concat(d.includes("success")?"text-green-500":"text-red-500"),children:d}),l?(0,r.jsx)("div",{className:"space-y-2",children:Array.from({length:5}).map((e,s)=>(0,r.jsxs)("div",{className:"flex justify-between items-center bg-gray-800 p-4 rounded-lg animate-pulse",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-700 rounded w-32"}),(0,r.jsx)("div",{className:"h-3 bg-gray-700 rounded w-48"})]}),(0,r.jsx)("div",{className:"h-10 bg-gray-700 rounded w-24"})]},s))}):a.length>0&&(0,r.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center bg-gray-800 p-4 rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white",children:e.name}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:e.email})]}),(0,r.jsx)("button",{onClick:()=>m(e.email),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg text-white",children:"Add Friend"})]},e.email))})]})}function N(){let[e,s]=(0,i.useState)([]),[a,t]=(0,i.useState)(!0),[l,n]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/friends");if(!e.ok)throw Error("Failed to fetch friends");let a=await e.json();s(a)}catch(e){console.error("Error fetching friends:",e)}finally{t(!1)}})()},[]);let d=()=>{let e=Date.now().toString(36),s=Math.random().toString(36).substring(2,10);return"room_".concat(e,"_").concat(s)},c=async e=>{try{let s=d(),a=await fetch("/api/meetings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:s})});if(!a.ok)throw Error("Failed to create meeting");let r=await a.json();if(!(await fetch("/api/meetings/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({meetingId:r.id,friendEmail:e})})).ok)throw Error("Failed to send invitation");window.location.href="/meeting/".concat(s)}catch(e){console.error("Error sending meeting invite:",e)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Friends"}),(0,r.jsx)("button",{onClick:()=>n(!l),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",children:l?"Hide Search":"Add Friends"})]}),l&&(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(y,{})}),a?(0,r.jsx)("div",{className:"grid gap-4",children:Array.from({length:5}).map((e,s)=>(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 flex items-center justify-between animate-pulse",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-gray-600"}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsx)("div",{className:"w-32 h-4 bg-gray-600 rounded-md"}),(0,r.jsx)("div",{className:"w-24 h-4 bg-gray-600 rounded-md"})]})]}),(0,r.jsx)("div",{className:"w-28 h-10 bg-gray-600 rounded-lg"})]},s))}):(0,r.jsx)("div",{className:"grid gap-4",children:e.map(e=>(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("online"===e.status?"bg-green-500":"bg-gray-500")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white",children:e.name}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:e.email})]})]}),(0,r.jsx)("div",{className:"space-x-2",children:(0,r.jsx)("button",{onClick:()=>c(e.email),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg",children:"Invite to Meet"})})]},e.email))})]})}function v(){let[e,s]=(0,i.useState)([]),[a,t]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/friends/requests");if(!e.ok)throw Error("Failed to fetch requests");let a=await e.json();s(a)}catch(e){console.error("Error fetching requests:",e)}finally{t(!1)}})()},[]);let l=async(a,r)=>{try{if(!(await fetch("/api/friends/requests/".concat(a,"/accept"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({senderEmail:r})})).ok)throw Error("Failed to accept request");s(e.filter(e=>e.id!==a))}catch(e){console.error("Error accepting request:",e)}},n=async(a,r)=>{try{if(!(await fetch("/api/friends/requests/".concat(a,"/reject"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({senderEmail:r})})).ok)throw Error("Failed to reject request");s(e.filter(e=>e.id!==a))}catch(e){console.error("Error rejecting request:",e)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Incoming Friend Requests"}),a?(0,r.jsx)("div",{className:"grid gap-4",children:Array.from({length:5}).map((e,s)=>(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 animate-pulse",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"w-32 h-4 bg-gray-600 rounded-md"}),(0,r.jsx)("div",{className:"w-40 h-4 bg-gray-600 rounded-md"}),(0,r.jsx)("div",{className:"w-24 h-3 bg-gray-600 rounded-md"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("div",{className:"w-20 h-10 bg-gray-600 rounded-lg"}),(0,r.jsx)("div",{className:"w-20 h-10 bg-gray-600 rounded-lg"})]})]})},s))}):(0,r.jsx)("div",{className:"grid gap-4",children:e.map(e=>(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white",children:e.sender.name}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:e.sender.email}),(0,r.jsxs)("p",{className:"text-gray-500 text-xs",children:["Sent: ",e.createdAt]})]}),(0,r.jsxs)("div",{className:"space-x-2",children:[(0,r.jsx)("button",{onClick:()=>l(e.id,e.sender.email),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg",children:"Accept"}),(0,r.jsx)("button",{onClick:()=>n(e.id,e.sender.email),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg",children:"Reject"})]})]})},e.id))})]})}function w(){var e,s;let{data:a}=(0,t.useSession)(),[g,p]=(0,i.useState)("meet"),[b,w]=(0,i.useState)(!1),k=async()=>{try{await fetch("/api/users/status",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"offline"})})}catch(e){console.error("Error updating status:",e)}await (0,t.signOut)({callbackUrl:"/"})},S=[{id:"meet",label:"New Meeting",icon:l.A},{id:"friends",label:"Friends",icon:n.A},{id:"search",label:"Add Friends",icon:d.A},{id:"requests",label:"Friend Requests",icon:c.A},{id:"previous",label:"Previous Meetings",icon:o.A}],E=e=>{var s,t,i;let{isMobile:l=!1}=e;return(0,r.jsxs)("div",{className:"flex flex-col h-full ".concat(l?"":"justify-between"),children:[(0,r.jsxs)("div",{className:"mb-8 flex items-center space-x-4 bg-gray-800/50 p-4 rounded-xl",children:[(null==a?void 0:null===(s=a.user)||void 0===s?void 0:s.image)?(0,r.jsx)("img",{src:a.user.image,alt:"Profile",className:"w-12 h-12 rounded-full ring-2 ring-purple-500"}):(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center ring-2 ring-purple-500",children:(0,r.jsx)(m.A,{className:"w-6 h-6 text-purple-200"})}),(0,r.jsxs)("div",{className:"flex flex-col truncate",children:[(0,r.jsx)("span",{className:"text-purple-50 text-lg font-medium truncate",children:null==a?void 0:null===(t=a.user)||void 0===t?void 0:t.name}),(0,r.jsx)("span",{className:"text-purple-200/70 text-sm truncate",children:null==a?void 0:null===(i=a.user)||void 0===i?void 0:i.email})]})]}),(0,r.jsx)("nav",{className:"flex-1 overflow-y-auto",children:(0,r.jsx)("ul",{className:"space-y-2",children:S.map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("button",{onClick:()=>{p(e.id),l&&w(!1)},className:"w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 ".concat(g===e.id?"bg-gradient-to-r from-purple-600 to-blue-600 text-white shadow-lg shadow-purple-500/20 scale-[1.02] font-medium":"text-gray-300 hover:bg-gray-800/50 hover:text-white hover:scale-[1.01]"),children:[(0,r.jsx)(e.icon,{className:"w-5 h-5 ".concat(g===e.id?"animate-pulse":"")}),(0,r.jsx)("span",{children:e.label})]})},e.id))})}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("button",{onClick:k,className:"flex items-center justify-center space-x-2 w-full bg-red-500/10 hover:bg-red-500/20 text-red-500 px-4 py-3 rounded-xl transition-colors border border-red-500/20 hover:border-red-500/30",children:[(0,r.jsx)(x.A,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:"Logout"})]})})]})};return(0,r.jsxs)("div",{className:"flex h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900",children:[(0,r.jsx)("div",{className:"hidden md:block w-72 bg-black/40 backdrop-blur-md h-full p-6 flex-shrink-0 border-r border-gray-800",children:(0,r.jsx)(E,{})}),(0,r.jsx)("div",{className:"md:hidden fixed top-0 left-0 right-0 bg-black/40 backdrop-blur-md z-50 border-b border-gray-800",children:(0,r.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(null==a?void 0:null===(e=a.user)||void 0===e?void 0:e.image)?(0,r.jsx)("img",{src:a.user.image,alt:"Profile",className:"w-8 h-8 rounded-full"}):(0,r.jsx)(m.A,{className:"w-8 h-8 text-purple-200"}),(0,r.jsx)("span",{className:"text-purple-50 font-medium",children:null==a?void 0:null===(s=a.user)||void 0===s?void 0:s.name})]}),(0,r.jsx)("button",{onClick:()=>w(!b),className:"p-2 text-purple-50 hover:bg-gray-800/50 rounded-lg",children:b?(0,r.jsx)(h.A,{className:"w-6 h-6"}):(0,r.jsx)(u.A,{className:"w-6 h-6"})})]})}),b&&(0,r.jsx)("div",{className:"md:hidden fixed inset-0 z-40 bg-black/40 backdrop-blur-md pt-16",children:(0,r.jsx)("div",{className:"h-full p-6",children:(0,r.jsx)(E,{isMobile:!0})})}),(0,r.jsx)("div",{className:"flex-1 md:p-8 p-4 overflow-y-auto bg-black/20 md:mt-0 mt-16",children:(0,r.jsx)("div",{className:"bg-black/40 backdrop-blur-md rounded-xl p-4 md:p-6 shadow-xl border border-gray-800",children:(0,r.jsx)("div",{className:"text-purple-50",children:(()=>{switch(g){case"meet":default:return(0,r.jsx)(j,{});case"friends":return(0,r.jsx)(N,{});case"requests":return(0,r.jsx)(v,{});case"search":return(0,r.jsx)(y,{});case"previous":return(0,r.jsx)(f,{})}})()})})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[615,313,441,517,358],()=>s(50762)),_N_E=e.O()}]);